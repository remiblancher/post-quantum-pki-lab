================================================================================
                    OPS-03: "Incident Drill"
                Algorithm Deprecation Response Diagrams
================================================================================

1. INCIDENT RESPONSE TIMELINE
────────────────────────────────────────────────────────────────────────────────

    ┌─────────────────────────────────────────────────────────────────────────┐
    │                    ALGORITHM DEPRECATION INCIDENT                       │
    └─────────────────────────────────────────────────────────────────────────┘

         T+0              T+1h             T+4h             T+8h
          │                │                │                │
          ▼                ▼                ▼                ▼
    ┌───────────┐    ┌───────────┐    ┌───────────┐    ┌───────────┐
    │ ALERT     │───>│ IDENTIFY  │───>│ REVOKE    │───>│ RE-ISSUE  │───> VERIFY
    │           │    │           │    │           │    │           │
    │ NIST      │    │ Scan all  │    │ CRL/OCSP  │    │ New certs │
    │ announces │    │ inventory │    │ update    │    │ deployed  │
    │ weakness  │    │           │    │           │    │           │
    └───────────┘    └───────────┘    └───────────┘    └───────────┘
          │                │                │                │
          │                │                │                │
          ▼                ▼                ▼                ▼
    "RSA-2048 is     "15 affected     "All revoked"    "Zero affected
     deprecated"      certs found"                       remaining"


2. THE PLAYBOOK
────────────────────────────────────────────────────────────────────────────────

    ┌─────────────────────────────────────────────────────────────────────────┐
    │                    INCIDENT RESPONSE PLAYBOOK                           │
    └─────────────────────────────────────────────────────────────────────────┘

    PHASE 1: DETECTION & ASSESSMENT
    ────────────────────────────────
    □ Receive alert (NIST, vendor, internal)
    □ Assess severity (critical, high, medium, low)
    □ Activate incident response team
    □ Begin timeline documentation

    PHASE 2: IDENTIFICATION
    ────────────────────────────────
    □ Run inventory scan (OPS-01)
    □ Filter by affected algorithm
    □ Identify all affected certificates
    □ Prioritize by criticality

    PHASE 3: CONTAINMENT & REVOCATION
    ────────────────────────────────
    □ Revoke affected certificates
    □ Update CRL/OCSP responders
    □ Notify affected service owners
    □ Document revocation timestamps

    PHASE 4: RECOVERY
    ────────────────────────────────
    □ Generate new key pairs (safe algorithm)
    □ Issue replacement certificates
    □ Deploy to affected services
    □ Verify deployment

    PHASE 5: POST-INCIDENT
    ────────────────────────────────
    □ Verify zero affected certs remaining
    □ Update inventory records
    □ Document lessons learned
    □ Update policies if needed


3. BEFORE vs AFTER
────────────────────────────────────────────────────────────────────────────────

    BEFORE INCIDENT                          AFTER INCIDENT
    ───────────────                          ──────────────

    ┌─────────────────────────────┐         ┌─────────────────────────────┐
    │       CERTIFICATE           │         │       CERTIFICATE           │
    │       INVENTORY             │         │       INVENTORY             │
    ├─────────────────────────────┤         ├─────────────────────────────┤
    │                             │         │                             │
    │  service-1.crt  RSA-2048 ✓  │   ──>   │  service-1.crt  ML-DSA-65 ✓ │
    │  service-2.crt  RSA-2048 ✓  │         │  service-2.crt  ML-DSA-65 ✓ │
    │  service-3.crt  ECDSA    ✓  │         │  service-3.crt  ECDSA    ✓  │
    │  service-4.crt  RSA-2048 ✓  │         │  service-4.crt  ML-DSA-65 ✓ │
    │                             │         │                             │
    │  Affected: 3                │         │  Affected: 0                │
    │  Status: AT RISK            │         │  Status: SECURED            │
    └─────────────────────────────┘         └─────────────────────────────┘


4. REVOCATION FLOW
────────────────────────────────────────────────────────────────────────────────

                    ┌─────────────────────┐
                    │   PKI Admin (Bob)   │
                    │   "Revoke cert!"    │
                    └──────────┬──────────┘
                               │
                               ▼
                    ┌─────────────────────┐
                    │   Certificate       │
                    │   Authority         │
                    │                     │
                    │   1. Mark revoked   │
                    │   2. Update CRL     │
                    │   3. Notify OCSP    │
                    └──────────┬──────────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
              ▼                ▼                ▼
    ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
    │   CRL Updated   │ │   OCSP Updated  │ │   CT Log        │
    │                 │ │                 │ │   (optional)    │
    │   Added to      │ │   Status: good  │ │   Revocation    │
    │   revocation    │ │   → revoked     │ │   recorded      │
    │   list          │ │                 │ │                 │
    └─────────────────┘ └─────────────────┘ └─────────────────┘


5. RE-ISSUANCE FLOW
────────────────────────────────────────────────────────────────────────────────

    ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
    │   REVOKED       │     │   NEW KEYS      │     │   NEW CERT      │
    │   CERTIFICATE   │────>│   GENERATED     │────>│   ISSUED        │
    │                 │     │                 │     │                 │
    │   RSA-2048      │     │   ML-DSA-65     │     │   ML-DSA-65     │
    │   COMPROMISED   │     │   (safe algo)   │     │   DEPLOYED      │
    └─────────────────┘     └─────────────────┘     └─────────────────┘
            │                                               │
            │                                               │
            ▼                                               ▼
    ┌─────────────────┐                            ┌─────────────────┐
    │   On CRL        │                            │   Service       │
    │   Not trusted   │                            │   Running       │
    │                 │                            │   Secured       │
    └─────────────────┘                            └─────────────────┘


6. INCIDENT REPORT TEMPLATE
────────────────────────────────────────────────────────────────────────────────

    ┌─────────────────────────────────────────────────────────────────────────┐
    │                    INCIDENT REPORT                                      │
    │                    ID: INC-2024-0042                                    │
    └─────────────────────────────────────────────────────────────────────────┘

    INCIDENT SUMMARY
    ───────────────────────────────────────────────────────────────────────────
    Date:        2024-01-15
    Severity:    HIGH
    Type:        Algorithm Deprecation
    Algorithm:   RSA-2048
    Reason:      NIST deprecation notice

    TIMELINE
    ───────────────────────────────────────────────────────────────────────────
    10:00  Alert received from NIST
    10:15  Incident team activated
    10:30  Inventory scan initiated
    11:00  15 affected certificates identified
    12:00  Revocation started
    14:00  All certificates revoked
    14:30  Re-issuance started
    17:00  All services updated
    17:30  Verification complete - 0 affected remaining

    AFFECTED ASSETS
    ───────────────────────────────────────────────────────────────────────────
    │ Certificate          │ Service         │ Action     │ Completed  │
    ├──────────────────────┼─────────────────┼────────────┼────────────┤
    │ api-server.crt       │ API Gateway     │ Rotated    │ 15:00      │
    │ web-frontend.crt     │ Web App         │ Rotated    │ 15:30      │
    │ internal-svc.crt     │ Internal API    │ Rotated    │ 16:00      │

    LESSONS LEARNED
    ───────────────────────────────────────────────────────────────────────────
    1. Inventory was essential for quick identification
    2. Automation reduced rotation time from days to hours
    3. Pre-staged PQC profiles enabled smooth transition


7. AUTOMATION BENEFITS
────────────────────────────────────────────────────────────────────────────────

    MANUAL RESPONSE                          AUTOMATED RESPONSE
    ───────────────                          ──────────────────

    ┌─────────────────────────────┐         ┌─────────────────────────────┐
    │                             │         │                             │
    │  Identify:    2-3 days      │         │  Identify:    minutes       │
    │  Revoke:      1-2 days      │         │  Revoke:      minutes       │
    │  Re-issue:    1 week        │         │  Re-issue:    hours         │
    │  Verify:      1 day         │         │  Verify:      minutes       │
    │  ─────────────────────      │         │  ─────────────────────      │
    │  Total:       2 weeks       │         │  Total:       8 hours       │
    │                             │         │                             │
    │  Risk:        HIGH          │         │  Risk:        LOW           │
    │  (window of vulnerability)  │         │  (minimal exposure)         │
    │                             │         │                             │
    └─────────────────────────────┘         └─────────────────────────────┘


================================================================================
                              END OF DIAGRAMS
================================================================================
