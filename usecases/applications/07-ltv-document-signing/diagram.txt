# APP-07: LTV Document Signing - Diagrams

## 1. The LTV Problem

WITHOUT LTV (Fragile):
======================

2024: Sign document
      │
      ├── Signature: ✓ Valid
      └── Certificate: ✓ Valid (OCSP says so)
                       │
                       └── CA Server: Online
                           OCSP: Online
                           CRL: Available

                    ~~~~ 30 YEARS PASS ~~~~

2055: Verify document
      │
      ├── Signature: ✓ Still mathematically valid
      └── Certificate: ??? CANNOT VERIFY
                       │
                       ├── CA Server: GONE (company closed)
                       ├── OCSP: GONE (server decommissioned)
                       └── CRL: GONE (URL 404)

      RESULT: ❌ CANNOT TRUST THE SIGNATURE


WITH LTV (Durable):
==================

2024: Sign document + Create LTV bundle
      │
      ├── Signature: ✓ Valid
      ├── Timestamp: ✓ Proves exact signing time
      ├── OCSP snapshot: ✓ Certificate was valid
      └── Chain: ✓ All CA certs bundled

      [Everything packaged in contract-ltv-bundle/]

                    ~~~~ 30 YEARS PASS ~~~~

2055: Verify document (OFFLINE - no network needed!)
      │
      ├── Signature: ✓ Still valid (ML-DSA is quantum-safe)
      ├── Timestamp: ✓ Signed on 2024-XX-XX at HH:MM:SS
      ├── OCSP snapshot: ✓ Cert was valid at signing time
      └── Chain: ✓ Verification succeeds using bundled certs

      RESULT: ✅ VERIFIED - LEGALLY BINDING


## 2. LTV Bundle Structure

┌──────────────────────────────────────────────────────────────┐
│                      LTV BUNDLE                               │
│                  contract-ltv-bundle/                         │
├──────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────┐    Original content                     │
│  │  document.txt   │    (the 30-year contract)               │
│  └─────────────────┘                                         │
│           │                                                   │
│           ▼                                                   │
│  ┌─────────────────┐    CMS signature                        │
│  │  signature.p7s  │    (ML-DSA-65, quantum-resistant)       │
│  └─────────────────┘                                         │
│           │                                                   │
│           ▼                                                   │
│  ┌─────────────────┐    RFC 3161 timestamp                   │
│  │  timestamp.tsr  │    (proves WHEN it was signed)          │
│  └─────────────────┘                                         │
│                                                               │
│  ┌─────────────────┐    Certificate chain                    │
│  │   chain.pem     │    (signer cert + CA cert)              │
│  └─────────────────┘                                         │
│                                                               │
│  ┌─────────────────┐    Bundle metadata                      │
│  │  manifest.json  │    (version, algorithm, components)     │
│  └─────────────────┘                                         │
│                                                               │
└──────────────────────────────────────────────────────────────┘


## 3. LTV Signing Flow

┌─────────────┐
│   Alice     │  Legal counsel
│  (Signer)   │
└──────┬──────┘
       │
       │ 1. Creates contract.txt
       ▼
┌─────────────────────────────────────────────────────────────┐
│                    SIGNING PROCESS                           │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Step 1: CMS Sign                                           │
│  ┌──────────┐     pki cms sign      ┌──────────────┐        │
│  │ contract │ ──────────────────────│ contract.p7s │        │
│  │   .txt   │                       │  (signature) │        │
│  └──────────┘                       └──────────────┘        │
│                                            │                │
│  Step 2: Timestamp                         ▼                │
│  ┌──────────────┐   pki tsa sign   ┌──────────────┐         │
│  │ contract.p7s │ ─────────────────│ contract.tsr │         │
│  │              │                  │ (timestamp)  │         │
│  └──────────────┘                  └──────────────┘         │
│                                            │                │
│  Step 3: Bundle                            ▼                │
│  ┌─────────────────────────────────────────────────┐        │
│  │            contract-ltv-bundle/                  │        │
│  │  document.txt + signature.p7s + timestamp.tsr   │        │
│  │            + chain.pem + manifest.json           │        │
│  └─────────────────────────────────────────────────┘        │
│                                                              │
└─────────────────────────────────────────────────────────────┘


## 4. LTV Verification Flow (Year 2055)

┌─────────────┐
│    Bob      │  Archivist (30 years later)
│ (Verifier)  │
└──────┬──────┘
       │
       │ Opens contract-ltv-bundle/
       ▼
┌─────────────────────────────────────────────────────────────┐
│                  VERIFICATION PROCESS                        │
│                   (Completely Offline)                       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Step 1: Verify Signature                                   │
│  ┌──────────────┐                                           │
│  │ signature.p7s│ ──┐                                       │
│  └──────────────┘   │                                       │
│  ┌──────────────┐   │   pki cms verify                      │
│  │ document.txt │ ──┼──────────────────── ✓ VALID           │
│  └──────────────┘   │                                       │
│  ┌──────────────┐   │                                       │
│  │  chain.pem   │ ──┘                                       │
│  └──────────────┘                                           │
│                                                              │
│  Step 2: Verify Timestamp                                   │
│  ┌──────────────┐                                           │
│  │ timestamp.tsr│ ──┐                                       │
│  └──────────────┘   │   pki tsa verify                      │
│  ┌──────────────┐   ├──────────────────── ✓ VALID           │
│  │ signature.p7s│ ──┤   "Signed: 2024-XX-XX"                │
│  └──────────────┘   │                                       │
│  ┌──────────────┐   │                                       │
│  │  chain.pem   │ ──┘                                       │
│  └──────────────┘                                           │
│                                                              │
│  Result: Document is VERIFIED and LEGALLY BINDING           │
│          No network access required!                         │
│                                                              │
└─────────────────────────────────────────────────────────────┘


## 5. Why PQC is Essential for LTV

                    TIMELINE
    ─────────────────────────────────────────────────────►

    2024                    2035?                    2055
      │                       │                        │
      ▼                       ▼                        ▼
   Sign with              Quantum                  Verify
   ML-DSA-65             computers                 document
      │                   arrive                      │
      │                       │                        │
      │                       │                        │
      ▼                       ▼                        ▼

   Classical (RSA/ECDSA):
   ┌──────────────────────────────────────────────────────┐
   │  ✓ Valid     │  ❌ Breakable  │  ❌ Forged sigs!     │
   └──────────────────────────────────────────────────────┘
                  Attacker can create fake "old" signatures

   Post-Quantum (ML-DSA-65):
   ┌──────────────────────────────────────────────────────┐
   │  ✓ Valid     │  ✓ Still safe  │  ✓ Still valid      │
   └──────────────────────────────────────────────────────┘
                  Quantum computers cannot break ML-DSA


## 6. LTV Retention Requirements

┌────────────────────┬─────────────────┬──────────────────┐
│   Document Type    │ Retention Period│  LTV Required?   │
├────────────────────┼─────────────────┼──────────────────┤
│ Legal contracts    │    10-30 years  │   ✓ REQUIRED     │
│ Medical records    │    50+ years    │   ✓ REQUIRED     │
│ Real estate deeds  │    Permanent    │   ✓ REQUIRED     │
│ Financial audits   │    7-10 years   │   ◐ Recommended  │
│ Software licenses  │    5-15 years   │   ◐ Recommended  │
│ Email archives     │    3-7 years    │   ○ Optional     │
└────────────────────┴─────────────────┴──────────────────┘

Legend: ✓ = Required, ◐ = Recommended, ○ = Optional
