================================================================================
UC-08: Post-Quantum Timestamping
================================================================================

THE THREAT: TIMESTAMP FORGERY
-----------------------------

TODAY                                    FUTURE (10-30 years)
─────                                    ────────────────────

┌────────────────────┐                   ┌────────────────────┐
│   Document needs   │                   │   Attacker with    │
│   timestamp proof  │                   │   quantum computer │
│                    │                   │                    │
│   TSA signs with   │                   │   Breaks TSA's     │
│   ECDSA            │                   │   ECDSA key        │
└─────────┬──────────┘                   └─────────┬──────────┘
          │                                        │
          │                                        │
          ▼                                        ▼
┌────────────────────┐                   ┌────────────────────┐
│   Timestamp token  │  ──────────────►  │   Forges valid     │
│   stored for       │                   │   timestamp on     │
│   legal compliance │                   │   BACKDATED        │
│   (30+ years)      │                   │   document         │
└────────────────────┘                   └─────────┬──────────┘
                                                   │
                                                   ▼
                                         ┌────────────────────┐
                                         │   "Legitimate"     │
                                         │   proof of events  │
                                         │   that never       │
                                         │   happened!        │
                                         └────────────────────┘


THE SOLUTION: PQC TIMESTAMPS
----------------------------

┌────────────────────┐
│   Document needs   │
│   timestamp proof  │
│                    │
│   TSA signs with   │
│   ML-DSA-65        │
└─────────┬──────────┘
          │
          ▼
┌────────────────────┐
│   Timestamp token  │
│   stored for       │
│   legal compliance │
│                    │
│   Valid for 30+    │
│   years            │
└─────────┬──────────┘
          │
          ▼
┌────────────────────┐
│   FUTURE: Even     │
│   with quantum     │
│   computer,        │
│   timestamp        │
│   CANNOT be        │
│   forged!          │
└────────────────────┘


DOCUMENT LIFESPAN vs QUANTUM TIMELINE
-------------------------------------

                    Today    2030     2040     2050     2060
                      │        │        │        │        │
                      ▼        ▼        ▼        ▼        ▼

Legal Contracts       ├─────────────────────────────────────────────────────┤
(30+ years)           │█████████████████████████████████████████████████████│ NEEDS PQC NOW

Patents               ├───────────────────────────────────────┤
(20+ years)           │███████████████████████████████████████│ NEEDS PQC NOW

Medical Records       ├─────────────────────────────────────────────┤
(Lifetime)            │████████████████████████████████████████████│ NEEDS PQC NOW

Financial Audits      ├──────────────────────────────┤
(10-15 years)         │█████████████████████████████│ NEEDS PQC NOW

AI Training Logs      ├───────────────────────────┤
(10+ years)           │██████████████████████████│ NEEDS PQC NOW

Tax Records           ├─────────────────────┤
(7-10 years)          │████████████████████│ PLAN FOR PQC

                      │        │
Quantum Threat?       │        └─────► Estimated quantum threat window
                      │                (5-15 years from now)


TIMESTAMPING WORKFLOW (RFC 3161)
--------------------------------

Same workflow, different algorithm:

Classical                              Post-Quantum
─────────                              ────────────

1. Client sends hash                   1. Client sends hash
   of document                            of document

2. TSA creates timestamp               2. TSA creates timestamp
   token (ECDSA signature)                token (ML-DSA signature)

3. Client stores token                 3. Client stores token
   with document                          with document

4. Verifier checks                     4. Verifier checks
   token (30 years later)                 token (30 years later)

     SIGNATURE MAY BE                      SIGNATURE REMAINS
     FORGED BY QUANTUM                     UNFORGEABLE FOREVER


┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   TIMESTAMP REQUEST (RFC 3161)                                              │
│                                                                             │
│   ┌────────────────────┐          ┌────────────────────┐                    │
│   │   Client           │          │   TSA              │                    │
│   │   Application      │          │   (ML-DSA-65)      │                    │
│   └─────────┬──────────┘          └─────────┬──────────┘                    │
│             │                               │                               │
│             │   1. Hash(document)           │                               │
│             │ ─────────────────────────────►│                               │
│             │                               │                               │
│             │   2. Timestamp Token          │                               │
│             │      (time + hash + sig)      │                               │
│             │ ◄─────────────────────────────│                               │
│             │                               │                               │
│                                                                             │
│   Token contains:                                                           │
│   - Timestamp (when)                                                        │
│   - Document hash (what)                                                    │
│   - TSA signature (proof) ← PQC signature!                                  │
│   - TSA certificate chain                                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘


SIZE COMPARISON
---------------

                      Classical              Post-Quantum
                      (ECDSA P-384)          (ML-DSA-65)

Signature Size        ████ ~96 B             ████████████████████████████████████ ~3,293 B

Token Size            ████████ ~2-3 KB       ████████████████████████████████████████ ~6-8 KB
(with cert chain)


For a 10 MB legal document:

┌──────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│  Document:     ████████████████████████████████████████████████  10 MB       │
│                                                                              │
│  + ECDSA:      │  (~0.03% overhead)                                          │
│                                                                              │
│  + ML-DSA:     ██ (~0.08% overhead)                                          │
│                                                                              │
│  NEGLIGIBLE OVERHEAD FOR 30+ YEARS OF LEGAL VALIDITY!                        │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘


LONG-TERM VALIDATION (LTV)
--------------------------

For timestamps to remain valid for decades, ALL signatures in the chain
must be quantum-resistant:

┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   LONG-TERM VALIDATION CHAIN                                                │
│                                                                             │
│   ┌──────────────┐     ┌──────────────┐     ┌──────────────┐                │
│   │   Document   │     │  Timestamp   │     │     TSA      │                │
│   │    Hash      │────►│    Token     │────►│ Certificate  │                │
│   └──────────────┘     └──────┬───────┘     └──────┬───────┘                │
│                               │                    │                        │
│                               ▼                    ▼                        │
│                         ┌──────────────┐     ┌──────────────┐               │
│                         │  ML-DSA-65   │     │  ML-DSA-65   │               │
│                         │  Signature   │     │  Signature   │               │
│                         └──────────────┘     └──────┬───────┘               │
│                                                     │                       │
│                                                     ▼                       │
│                                              ┌──────────────┐               │
│                                              │   Root CA    │               │
│                                              │  ML-DSA-87   │               │
│                                              └──────────────┘               │
│                                                                             │
│   ✓ Document integrity proven by hash                                       │
│   ✓ Timestamp proven by PQC signature                                       │
│   ✓ TSA identity proven by PQC certificate                                  │
│   ✓ Trust anchor: PQC Root CA                                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘


USE CASES FOR PQC TIMESTAMPING
------------------------------

┌─────────────────────────────────────────────────────────────────────────────┐
│  USE CASE                    │  WHY PQC MATTERS                             │
├─────────────────────────────────────────────────────────────────────────────┤
│  Legal Contracts             │  30+ year retention, court admissibility     │
│  Patents & IP                │  Priority disputes decades later             │
│  Medical Records             │  Lifetime retention requirements             │
│  Financial Audits            │  Regulatory compliance (SOX, etc.)           │
│  AI/ML Training Data         │  Prove data existed before certain dates     │
│  Digital Evidence            │  Chain of custody for legal proceedings      │
│  Regulatory Filings          │  SEC, FDA submissions with long retention    │
└─────────────────────────────────────────────────────────────────────────────┘


THE KEY MESSAGE
---------------

┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   "TRUST NOW, VERIFY FOREVER"                                               │
│                                                                             │
│   ✓ Timestamps prove when documents existed                                 │
│   ✓ Legal requirements demand 30+ years of validity                         │
│   ✓ Classical signatures can be forged by quantum computers                 │
│   ✓ PQC signatures (ML-DSA) remain unforgeable                              │
│   ✓ Token size overhead is negligible for legal documents                   │
│                                                                             │
│   Timestamping is the LONGEST-LIVED cryptographic proof.                    │
│   If you're timestamping today, you NEED PQC.                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘


================================================================================
                          QentriQ - https://qentriq.com
================================================================================
