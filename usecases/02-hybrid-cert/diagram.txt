UC-02: Hybrid Certificate (Catalyst) Structure
==============================================


CLASSICAL CERTIFICATE                    HYBRID (CATALYST) CERTIFICATE
─────────────────────                    ─────────────────────────────

┌─────────────────────┐                  ┌─────────────────────────────┐
│   X.509 Certificate │                  │      X.509 Certificate      │
├─────────────────────┤                  ├─────────────────────────────┤
│ Subject: CN=...     │                  │ Subject: CN=...             │
│                     │                  │                             │
│ Public Key:         │                  │ Public Key:                 │
│   ECDSA P-384       │                  │   ECDSA P-384 (classical)   │
│   [97 bytes]        │                  │   [97 bytes]                │
│                     │                  │                             │
│ Extensions:         │                  │ Extensions:                 │
│   - Key Usage       │                  │   - Key Usage               │
│   - SAN             │                  │   - SAN                     │
│   - ...             │                  │   - Alt Public Key (9.8)    │
│                     │                  │       ML-DSA-65 [1952 B]    │
│                     │                  │   - Alt Signature (9.8)     │
│                     │                  │       ML-DSA-65 [3293 B]    │
│                     │                  │   - ...                     │
│                     │                  │                             │
│ Signature:          │                  │ Signature:                  │
│   ECDSA P-384       │                  │   ECDSA P-384 (classical)   │
│   [96 bytes]        │                  │   [96 bytes]                │
└─────────────────────┘                  └─────────────────────────────┘

     ~1 KB total                              ~6 KB total


CLIENT BEHAVIOR
───────────────

Legacy Client (non-PQC aware):
┌────────────────────────────────────────────────────────────────────┐
│                                                                    │
│   1. Parse certificate                                             │
│   2. Extract ECDSA public key                                      │
│   3. Verify ECDSA signature                                        │
│   4. Ignore unknown extensions (per X.509 spec)                    │
│                                                                    │
│   Result: Works normally, no code changes needed                   │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘

Modern Client (PQC aware):
┌────────────────────────────────────────────────────────────────────┐
│                                                                    │
│   1. Parse certificate                                             │
│   2. Recognize Catalyst extensions (ITU-T X.509 9.8)               │
│   3. Extract BOTH public keys (ECDSA + ML-DSA)                     │
│   4. Verify BOTH signatures                                        │
│      - ECDSA signature ✓                                           │
│      - ML-DSA signature ✓                                          │
│   5. Use quantum-safe key for session                              │
│                                                                    │
│   Result: Full quantum protection                                  │
│                                                                    │
└────────────────────────────────────────────────────────────────────┘


MIGRATION TIMELINE
──────────────────

Today                    Transition              Future
  │                          │                      │
  ▼                          ▼                      ▼
┌──────────┐           ┌──────────┐           ┌──────────┐
│ Classical│           │  Hybrid  │           │ Pure PQC │
│   Only   │  ──────►  │ (Both)   │  ──────►  │   Only   │
│          │           │          │           │          │
│ ECDSA    │           │ ECDSA +  │           │ ML-DSA   │
│          │           │ ML-DSA   │           │          │
└──────────┘           └──────────┘           └──────────┘

     │                      │                      │
     │                      │                      │
     ▼                      ▼                      ▼
  Legacy              All clients              Only PQC
  clients             supported               clients
  only


DEFENSE IN DEPTH
────────────────

                    ┌─────────────────────────┐
                    │    Hybrid Certificate   │
                    └────────────┬────────────┘
                                 │
              ┌──────────────────┴──────────────────┐
              │                                     │
              ▼                                     ▼
     ┌─────────────────┐                 ┌─────────────────┐
     │     ECDSA       │                 │     ML-DSA      │
     │   (Classical)   │                 │  (Post-Quantum) │
     └────────┬────────┘                 └────────┬────────┘
              │                                   │
              ▼                                   ▼
     ┌─────────────────┐                 ┌─────────────────┐
     │  Protected      │                 │  Protected      │
     │  against        │                 │  against        │
     │  classical      │                 │  quantum        │
     │  attacks        │                 │  attacks        │
     └─────────────────┘                 └─────────────────┘

If ECDSA is broken → ML-DSA still protects
If ML-DSA is broken → ECDSA still protects
